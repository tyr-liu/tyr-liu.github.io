---
layout:     post
title:      "数据密集型应用设计（三）"
subtitle:   "读书手记"
date:       2020-05-10 23:10:00
author:     "Tyr"
header-img: "img/low-angle-photography-of-library-1296000.jpg"
tags:
    - 读书笔记
    - 软件架构
    - 数据密集型应用设计
---

## 存储与检索

> 如果说前章列举的是人类如何描述数据存储和获取，那么本章则是从数据库的角度去描述，数据库如何实现存储和检索。

### 记录与索引

这章内容概念和原理比较多，看了有段时间，比较纠结，从总结的角度来说，如果写的比较细就变成了抄书，因为书中描述的确实比较深入浅出，婉婉道来。如果从自己角度理解来说，只能是写些泛泛。先泛泛写写吧。

#### LSM树与B树

 - LSM树

尾部追加，丢弃过时，压缩合并，不做更新。

优势在于：写入速度快，数据紧凑体积小

缺点在于：压缩操作影响请求响应，大数据量时压缩操作开销不可测，由于多副本存在不如B树对事务锁的支持

- B树

就地更新，固定大小的页

优势在于：更好的读取效率，更好的事务支持，是关系型数据库常用结构

缺点在于：每次复写及日志写入降低写入效率，分割新页，会有页碎片增加存放体积

#### OLTP和OLAP

| 属性 | 事务处理 OLTP | 分析系统 OLAP |
| ------ | ------ | ------ |
|主要读取模式 |查询少量记录，按键读取 | 在大批量记录上聚合
|主要写入模式 | 随机访问，写入要求低延时  | 批量导入（ETL），事件流
|主要用户 |终端用户，通过Web应用 | 内部数据分析师，决策支持
|处理的数据 | 数据的最新状态（当前时间点）| 随时间推移的历史事件
|数据集尺寸 | GB ~ TB | TB ~ PB

#### 列存储

列存储对于数据仓库来说，只提取需要的数据列，可以有效减少磁盘吞吐量，通过位图压缩等压缩算法可以进一步减少吞吐量。